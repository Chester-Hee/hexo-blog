<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="code farmer."><title>docker 简单入门教程 | 追赶日落日出</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?66bdd0a984d281716c78a567d1f39e67";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">首页</a><a class="sidebar-nav-item" href="/archives">归档</a><a class="sidebar-nav-item" href="/about">关于我</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Docker/">Docker</a></div><div class="post-time">2018-04-11</div></div></div><div class="container post-header"><h1>docker 简单入门教程</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-简单入门教程"><span class="toc-number">1.</span> <span class="toc-text">docker 简单入门教程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#简介"><span class="toc-number">1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装-docker"><span class="toc-number">1.2.</span> <span class="toc-text">安装 docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-image-基本命令"><span class="toc-number">1.3.</span> <span class="toc-text">docker image 基本命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#拉取镜像"><span class="toc-number">1.3.1.</span> <span class="toc-text">拉取镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#镜像列表"><span class="toc-number">1.3.2.</span> <span class="toc-text">镜像列表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除镜像"><span class="toc-number">1.3.3.</span> <span class="toc-text">删除镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#定制镜像"><span class="toc-number">1.3.4.</span> <span class="toc-text">定制镜像</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-container-基本命令"><span class="toc-number">1.4.</span> <span class="toc-text">docker container 基本命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#新建并启动容器"><span class="toc-number">1.4.1.</span> <span class="toc-text">新建并启动容器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取容器列表"><span class="toc-number">1.4.2.</span> <span class="toc-text">获取容器列表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#终止容器"><span class="toc-number">1.4.3.</span> <span class="toc-text">终止容器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#进入已经启动容器"><span class="toc-number">1.4.4.</span> <span class="toc-text">进入已经启动容器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除容器"><span class="toc-number">1.4.5.</span> <span class="toc-text">删除容器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-三剑客之-compose"><span class="toc-number">1.5.</span> <span class="toc-text">docker 三剑客之 compose</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#安装"><span class="toc-number">1.5.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#命令"><span class="toc-number">1.5.2.</span> <span class="toc-text">命令</span></a></li></ol></li></ol></li></ol></details></div><div class="container post-content"><h2 id="docker-简单入门教程"><a href="#docker-简单入门教程" class="headerlink" title="docker 简单入门教程"></a>docker 简单入门教程</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>docker 是个划时代的开源项目，它彻底释放了计算虚拟化的威力，极大提高了应用的维护效率，降低了云计算应用开发的成本！使用 Docker，可以让应用的部署、测试和分发都变得前所未有的高效和轻松！</p>
<p>无论是应用开发者、运维人员、还是其他信息技术从业人员，都有必要认识和掌握 docker，节约有限的生命。</p>
<h3 id="安装-docker"><a href="#安装-docker" class="headerlink" title="安装 docker"></a>安装 docker</h3><p><code>docker</code> 分为两个程序<code>服务器</code>与<code>客户端</code></p>
<ul>
<li>服务端是一个服务进程，管理着所有的容器</li>
<li>客户端则扮演着 docker 服务端的远程控制器</li>
</ul>
<p>安装 docker 有两个版本选择<code>Community Edition (CE)</code> 和 <code>Enterprise Edition (EE)</code></p>
<ul>
<li>Enterprise Edition (EE) 是企业级付费版本</li>
<li>Community Edition (CE) 这个是免费的</li>
</ul>
<p>CE 下载安装文档路径：</p>
<ul>
<li>ubuntu：<a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" target="_blank" rel="noopener">https://docs.docker.com/install/linux/docker-ce/ubuntu/</a></li>
<li>Mac：<a href="https://docs.docker.com/docker-for-mac/install/" target="_blank" rel="noopener">https://docs.docker.com/docker-for-mac/install/</a></li>
<li>Windows：<a href="https://docs.docker.com/docker-for-windows/install/" target="_blank" rel="noopener">https://docs.docker.com/docker-for-windows/install/</a></li>
</ul>
<h3 id="docker-image-基本命令"><a href="#docker-image-基本命令" class="headerlink" title="docker image 基本命令"></a>docker image 基本命令</h3><p>docker 镜像操作类似于 git 操作</p>
<h4 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker pull ubuntu:16.04</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">16.04: Pulling from library/ubuntu</span><br><span class="line">22dc81ace0ea: Downloading [=======&gt;                                           ]  6.586MB/42.96MB</span><br><span class="line">1a8b3c87dba3: Download complete </span><br><span class="line">91390a1c435a: Download complete </span><br><span class="line">07844b14977e: Download complete </span><br><span class="line">b78396653dae: Download complete </span><br><span class="line"></span><br><span class="line">获取镜像：docker pull [选项] [Docker Registry 地址[:端口号]/]仓库名[:标签]</span><br></pre></td></tr></table></figure>
<h4 id="镜像列表"><a href="#镜像列表" class="headerlink" title="镜像列表"></a>镜像列表</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker image ls</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">ubuntu              16.04               f975c5035748        5 weeks ago         112MB</span><br></pre></td></tr></table></figure>
<h4 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image rm [选项] &lt;镜像1&gt; [&lt;镜像2&gt; ...]</span><br></pre></td></tr></table></figure>
<p>通常要强制删除，添加参数 -f</p>
<h4 id="定制镜像"><a href="#定制镜像" class="headerlink" title="定制镜像"></a>定制镜像</h4><p>使用Dockerfile定制镜像</p>
<h3 id="docker-container-基本命令"><a href="#docker-container-基本命令" class="headerlink" title="docker container 基本命令"></a>docker container 基本命令</h3><p>镜像都是在容器上运行的</p>
<h4 id="新建并启动容器"><a href="#新建并启动容器" class="headerlink" title="新建并启动容器"></a>新建并启动容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -it ubuntu bash</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line"> Unable to find image 'ubuntu:latest' locally</span><br><span class="line"> latest: Pulling from library/ubuntu</span><br><span class="line"> Digest: sha256:e348fbbea0e0a0e73ab0370de151e7800684445c509d46195aef73e090a49bd6</span><br><span class="line"> Status: Downloaded newer image for ubuntu:latest</span><br><span class="line"> root@fdfbf1ce305a:/#</span><br></pre></td></tr></table></figure>
<p>其中，-t 选项让Docker分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上， -i 则让容器的标准输入保持打开。</p>
<p>当利用 docker run 来创建容器时，Docker 在后台运行的标准操作包括：</p>
<ul>
<li>检查本地是否存在指定的镜像，不存在就从公有仓库下载</li>
<li>利用镜像创建并启动一个容器</li>
<li>分配一个文件系统，并在只读的镜像层外面挂载一层可读写层</li>
<li>从宿主主机配置的网桥接口中桥接一个虚拟接口到容器中去</li>
<li>从地址池配置一个 ip 地址给容器</li>
<li>执行用户指定的应用程序</li>
<li>执行完毕后容器被终止</li>
</ul>
<h4 id="获取容器列表"><a href="#获取容器列表" class="headerlink" title="获取容器列表"></a>获取容器列表</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container ls -a</span><br></pre></td></tr></table></figure>
<h4 id="终止容器"><a href="#终止容器" class="headerlink" title="终止容器"></a>终止容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container stop</span><br></pre></td></tr></table></figure>
<h4 id="进入已经启动容器"><a href="#进入已经启动容器" class="headerlink" title="进入已经启动容器"></a>进入已经启动容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it webserver bash</span><br></pre></td></tr></table></figure>
<h4 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">删除容器：</span><br><span class="line">docker container rm trusting_newton</span><br><span class="line"></span><br><span class="line">清理所有容器：</span><br><span class="line">docker container prune</span><br></pre></td></tr></table></figure>
<h3 id="docker-三剑客之-compose"><a href="#docker-三剑客之-compose" class="headerlink" title="docker 三剑客之 compose"></a>docker 三剑客之 compose</h3><p><code>compose</code> 是定义和运行多容器 docker 应用程序的工具。使用compose，您可以使用 YAML 文件来配置应用程序的服务。compose 项目是 docker 官方的开源项目，负责实现对 docker 容器集群的快速编排。从功能上看，跟 OpenStack 中的 Heat 十分类似 compose 的默认管理对象是项目，通过子命令对项目中的一组容器进行便捷地生命周期管理</p>
<p>重要两个概念：</p>
<ul>
<li>服务 (service)：一个应用的容器，实际上可以包括若干运行相同镜像的容器实例</li>
<li>项目 (project)：由一组关联的应用容器组成的一个完整业务单元，在 docker-compose.yml 文件中定义</li>
</ul>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>安装地址：<a href="https://docs.docker.com/compose/install/#install-compose" target="_blank" rel="noopener">https://docs.docker.com/compose/install/#install-compose</a></p>
<h4 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h4><p>命令说明：<a href="https://yeasy.gitbooks.io/docker_practice/content/compose/commands.html" target="_blank" rel="noopener">https://yeasy.gitbooks.io/docker_practice/content/compose/commands.html</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up [options] [SERVICE...]</span><br><span class="line"></span><br><span class="line">该命令十分强大，它将尝试自动完成包括构建镜像，（重新）创建服务，启动服务，并关联服务相关容器的一系列操作</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line">将会在后台启动并运行所有的容器。一般推荐生产环境下使用该选项</span><br></pre></td></tr></table></figure></div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>